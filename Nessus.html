<p>&nbsp;</p>
<div>
<h1 dir="RTL" style="text-align: justify;">עקיפת המגבלה של סריקת 16 כתובות IP בגירסה החינמית של Nessus</h1>
</div>
<div>
<p dir="RTL" style="text-align: justify;">&nbsp;</p>
</div>
<div>
<p dir="RTL" style="text-align: justify;">התקנתי על המחשב שלי את הגירסה החינמית של Nessus ראיתי שיש פיצ'רים העולים כסף, אך בסה"כ התוכנה עבדה ממש יפה, הצליחה לאתר Exploit, ובאמת לא הבנתי מדוע עלי לשלם את המחיר המפורז אותו הם דורשים עבור גירסת הפרימיום.</p>
</div>
<div>
<p dir="RTL" style="text-align: justify;">אך שמחתי לא ארכה זמן רב, היות ולאחר שסרקתי 16 כתובות IP שונות, קיבלתי את ההודעה שהגירסה שברשותי מוגבלת לסריקת 16 כתובות IP שונות...</p>
</div>
<div>
<p dir="RTL" style="text-align: justify;">במחשבה הראשונה הבנתי שהמקרה עבוד, לא העליתי בדעתי שניתן לעקוף את החסימה הזאת, היות והתוכנה מחוברת Online &nbsp;לרשת והיה לי ברור שכל הסריקות שלי נשמרו בענן, אך היות ולשלם כסף לא רציתי, החלטתי להרשם שוב ולקבל קוד נוסף כך שיהיו לי 16 סריקות נוספות.</p>
</div>
<div>
<p dir="RTL" style="text-align: justify;">נרשמתי שוב לאתר של Nessus, האמת שנרשמתי עם אותה כתובת מייל רק שבאמצע הכתובת הוספתי נקודה כך שמבחינת Nessus &nbsp;הכנסתי כעת כתובת שונה, אך ביחס ל- Gmail נשארתי עם אותה כתובת, היות ו- Gmail מתעלמים מנקודות בתוך כתובת המייל, קיבלתי קוד נוסף החלפתי את קוד הרישום, אך... החסימה נשארה, הבנתי שיש איזשהו ערך לוקאלי שנשמר בתוך הדיסק קשיח שלי, שבו נרשמו מספר הכתובות שסרקתי.</p>
</div>
<div>
<p dir="RTL" style="text-align: justify;">החלטתי לבדוק האם המידע נשמר אך ורק בצורה לוקאלית, או גם לוקאלית וגם בענן, התקנתי את ה-Nessus, במערכת ה-Kali שברשותי ורשמתי את הקוד הראשון שקיבלתי בעת ההרשמה הראשונה, הפעלתי את הNessus ו.. איזה פלא, המערכת עבדה ללא כל מגבלה, כמובן עד שסרקתי 16 כתובות ושוב נחסמתי, הבנתי שהחסימה היא נטו לוקאלית, וכל מה שנותר זה רק למצוא את המיקום בו המערכת שומרת את ההיסטוריה שלי.</p>
</div>
<div>
<p dir="RTL" style="text-align: justify;">בנוסף, שמתי לב שכאשר אני מכניס כתובת IP לסריקה לוקח זמן עד שהמערכת מציגה את ההודעה שאין לי אפשרות לראות את התוצאה היות וחרגתי מהמגבלה הקיימת, ובמידה והחסימה היא באתר, בטרם הסריקה המערכת אמורה לבדוק האם יש לי הרשאת סריקה או שכבר חרגתי, כאן קיבלתי הוכחה נוספת לכך שהחסימה היא רק לוקאלית, וכנראה שהמתכנתים של Nessus אולי הם מומחים בתקיפה אבל הם ממש טירונים בהגנה, האמת שהתחושה הזאת התאמתה בהמשך אך פשוט נדהמתי עד כמה.</p>
</div>
<div>
<p dir="RTL" style="text-align: justify;">ניסיתי קצת לחפש בגוגל, וראיתי שיש פקודה שדרכה ניתן לאפס את ההגדרות של Nessus הפקודה היא:</p>
</div>
<div>
<p style="text-align: justify;">nessuscli.exe fix --reset-all</p>
</div>
<div>
<p dir="RTL" style="text-align: justify;">הרצתי את הפקודה, אך המגבלה עדיין הייתה קיימת, המשכתי לחפש במטרה למצוא איך אני יכול למחוק את המשתמש הקיים, אולי מחיקת המשתמש תצליח למחוק את רישום ההיסטוריה.</p>
</div>
<div>
<p dir="RTL" style="text-align: justify;">מצאתי את הפקודה הבא:</p>
</div>
<div>
<p style="text-align: justify;">nessuscli.exe rmuser</p>
</div>
<div>
<p dir="RTL" style="text-align: justify;">הרצתי אותה, והפלא ופלא המערכת איפסה את עצמה, ויכולתי לסרוק שוב.</p>
</div>
<div>
<p dir="RTL" style="text-align: justify;">התחלתי להשתולל סרקתי וסרקתי עד שנחסמתי שוב, אבל אני כבר הייתי בעל ניסיון, הרצתי שוב את שני הפקודות, אך הפעם המערכת התאפסה לגמרי, מחקה את כל ההיסטוריה והייתי צריך אף ליצור מחדש את המשתמש שלי, דבר שלקח הרבה זמן, והיה לי חבל על כל ההיסטוריה שנעלמה.</p>
</div>
<div>
<p dir="RTL" style="text-align: justify;">היות וכבר הבנתי שאני מתמודד מול משהו חובבני, נכנסתי לתיקיה של התוכנה, ועקבתי לפי תאריך השינוי בניסיון לאתר איזה קבצים משתנים בכל סריקה וסריקה, ראיתי שיש קבצים עם סיומת DB שהם קבצי Data של Sqlite הבנתי שכאן טמון הכלב, לאחר שנחסמתי התחלתי לעבור על כל אחד מהקבצים כדי לראות מה יקרה לתוכנה במידה והוא יעלם, כמובן שלא הצלחתי למחוק את הקבצים היות והם היו פתוחים ע"י התוכנה, ולכן כל פעם נאלצתי לסגור את ה-Service ע"י הפקודה Net Stop &ldquo;Tenable Nessus&rdquo; ולאחמ"כ להפעיל ע"י הפקודה Net Start &ldquo;Tenable Nessus&rdquo; וגיליתי שישנם שלושה קבצים שבמידה ואני מוחק אותם המגבלה נעלמת, אך ההיסטוריה עדיין נשארת:</p>
</div>
<div>
<p style="text-align: justify;">del "%ALLUSERSPROFILE%\Tenable\Nessus\nessus\ext.db"</p>
</div>
<div>
<p style="text-align: justify;">del "%ALLUSERSPROFILE%\Tenable\Nessus\nessus\global.db"</p>
</div>
<div>
<p style="text-align: justify;">del "%ALLUSERSPROFILE%\Tenable\Nessus\nessus\upgrades.db"</p>
</div>
<div>
<p dir="RTL" style="text-align: justify;">רציתי ליצור קובץ BAT &nbsp;שיכיל את הפקודות הנ"ל אך הייתי צריך, כל פעם להפעיל אותו עם הרשאות מנהל, לכן בתחילת הקובץ כתבתי סקריפט שבודק האם הקובץ רק עם הרשאות מנהל, ובמידה ואני מקבל שגיאה (עקב מחסור בהרשאות), אני מייצר קובץ VBScript שהוא מריץ את הסקריפט שכתבתי עם הרשאות מנהל, ו... איזה יופי הסקריפט עובד וניתן להוריד אותו מ<a href="https://github.com/moshefurman/NessusReset/blob/master/NessusReset.bat">כאן</a>.</p>
</div>
<div>
<p style="text-align: justify;">&nbsp;</p>
</div>
